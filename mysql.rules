groups:
- name: mysql
  rules:
  - alert: mysql断开警告
    expr: mysql_up== 0
    for: 1s
    labels:
      severity: error
      value: '{{$value}}'
      dingUrl: "https://oapi.dingtalk.com/robot/send?access_token=e52bd263e9ceef99c7cd00d953430ea9dc486c05c3454c0f450abeac11c610c6"
      isAtAll: "flase"
      atList: "15260826071"
    annotations:
      summary: " {{ $labels.instance }} mysql is down"
      description: "mysql中断请及时处理@15260826071"

  - alert: Mysql_High_QPS警告
    expr: rate(mysql_global_status_questions[5m]) > 500 
    for: 2m
    labels:
      severity: warning
      value: '{{$value}}'
      dingUrl: "https://oapi.dingtalk.com/robot/send?access_token=e52bd263e9ceef99c7cd00d953430ea9dc486c05c3454c0f450abeac11c610c6"
      isAtAll: "flase"
      atList: "15260826071"
    annotations:
      summary: "{{$labels.instance}}: Mysql_High_QPS detected"
      description: "{{$labels.instance}}: Mysql opreation is more than 500 per second ,(current value is: {{ $value }}) @15260826071"

  - alert: Mysql_Too_Many_slow_queries警告
    expr: rate(mysql_global_status_slow_queries[5m]) > 3
    for: 2m
    labels:
      severity: warning
      value: '{{$value}}'
      dingUrl: "https://oapi.dingtalk.com/robot/send?access_token=e52bd263e9ceef99c7cd00d953430ea9dc486c05c3454c0f450abeac11c610c6"
      isAtAll: "flase"
      atList: "15260826071"
    annotations:
      summary: "{{$labels.instance}}: Mysql_Too_Many_slow_queries detected"
      description: "{{$labels.instance}}: Mysql slow_queries is more than 3 per second ,(current value is: {{ $value }})@15260826071"
